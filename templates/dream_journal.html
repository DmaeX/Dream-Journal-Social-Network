<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Dream Journal</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
  </head>

  <body>
    <video autoplay muted loop id="myVideo">
      <source src="/static/starry_night_2.mp4" type="video/mp4">
    </video>

    <div class="container">
      <h1>ðŸŒ™ My Dream Journal</h1>
      <form id="dreamForm">
        <label for="title">Dream Title:</label>
        <input type="text" id="title" name="title" required>
  
        <label for="date">Date:</label>
        <input type="date" id="date" name="date" required>
  
        <label for="content">Describe Your Dream:</label>
        <textarea id="content" name="content" rows="5" placeholder="What did you dream about?" required></textarea>
  
        <label for="mood">How did you feel?</label>
        <select id="mood" name="mood">
          <option value="happy">ðŸ˜Š Happy</option>
          <option value="scared">ðŸ˜± Scared</option>
          <option value="sad">ðŸ˜¢ Sad</option>
          <option value="weird">ðŸ¤” Weird</option>
        </select>
  
        <input type="submit" value="Save Dream">
      </form>
  
      <!-- ðŸŒŒ Section to show saved dreams -->
      <h2>ðŸª¶ Your Saved Dreams</h2>
      <div id="dreamList"></div>
  
      <div id="weatherResult" class="result">
    </div>

    
    <!-- ðŸŒŒ Section to show saved dreams -->
    <h2>ðŸª¶ Your Saved Dreams</h2>
    <div id="dreamList"></div>

    <script>

      const form = document.getElementById("dreamForm");
      const dreamList = document.getElementById("dreamList");

      // Load dreams from localStorage on page load
      window.onload = function() {
        showDreams();
      };

      // Save dream on form submit
      form.addEventListener("submit", function(e) {
        e.preventDefault();

        const dream = {
          title: document.getElementById("title").value,
          date: document.getElementById("date").value,
          content: document.getElementById("content").value,
          mood: document.getElementById("mood").value
        };

        // Get old dreams, add new one
        let dreams = JSON.parse(localStorage.getItem("dreams")) || [];
        dreams.push(dream);
        localStorage.setItem("dreams", JSON.stringify(dreams));

        // Clear form and refresh dream list
        form.reset();
        showDreams();
      });

      // Function to display dreams
      function showDreams() {
        dreamList.innerHTML = "";
        let dreams = JSON.parse(localStorage.getItem("dreams")) || [];

        if (dreams.length === 0) {
          dreamList.innerHTML = "<p>No dreams logged yet ðŸ’¤</p>";
          return;
        }

        dreams.forEach((d, index) => {
          const dreamCard = document.createElement("div");
          dreamCard.classList.add("dream");
          dreamCard.innerHTML = `
            <h3>${d.title}</h3>
            <p class="dream-date">${d.date} | Mood: ${d.mood}</p>
            <p>${d.content}</p>
            <button onclick="deleteDream(${index})" style="background:#ff6b6b; color:white; border:none; border-radius:6px; padding:5px 10px; cursor:pointer;">Delete</button>
          `;
          dreamList.prepend(dreamCard); // newest first
        });
      }

      // Delete a dream
      function deleteDream(index) {
        let dreams = JSON.parse(localStorage.getItem("dreams")) || [];
        dreams.splice(index, 1);
        localStorage.setItem("dreams", JSON.stringify(dreams));
        showDreams();
      }
    </script>
  </body>
</html>
